<div class="container py-5">


    <h3>Liste des questions</h3>
    <hr>

    <div *ngIf="allQuestions">
        <div *ngFor="let q of allQuestions">
             <!-- pour vérification en base si besoin de l'intégralité des questions -->
            <!-- {{q | json}} -->

            <!-- début de la question -->
            <div class="p-3 p-md-5 d-flex flex-column justify-content-between align-items-center rounded mb-3">
                <p class="rounded bg-primary px-3 py-2 h3 fw-normal shadow-sm">Question n°{{q.number}} : {{q.question}}
                </p>
                <p class="fs-6"><span class="fw-bold">Métier :</span> {{q.sigle}} - <span class="fw-bold">Id :</span>
                    {{q.id}} - <a class="fw-bold" [routerLink]="['/updateQuestion',q.id]">Modifier</a></p>

                <!-- essai insertion boucle image / video différenciation du traitement -->
                <div *ngIf="questionsMedias">
                    <!-- pour vérification en base si besoin de la source du media lié à une question -->
                    <!-- {{questionsMedias}} -->

                    <div class="bg-light rounded rounded mb-3" *ngFor="let item of questionsMedias">
                        <div class="w-100 bg-primary p-2 rounded" *ngIf="item.includes(q.id)">

                            <!-- si fichier de type video / sinon utiliser le template pour l'image  -->
                            <video *ngIf="q.isVideo==true; else image" class="video" controls (ended)="displayResponseIfVideoEnded()">
                                <source [src]="item" type="video/mp4">
                                Your browser does not support HTML video.
                            </video>
                            <ng-template #image><img class="img-fluid" [src]="item"></ng-template>
                        </div>

                    </div>
                </div>
                <!-- fin de la question -->

                <!-- début des réponses -->
                <div class="p-3 p-md-5 row justify-content-between align-items-center mb-3 rounded bg-light" [ngClass]="{'opacity-0': questionsMedias && q.isVideo==true && !videoEnded, 'opacity-100': questionsMedias && q.isVideo && videoEnded}">

                    <div class="col-sm-6 rounded" [ngClass]="{'text-success':q.optScoring1=='true'}">
                        <p class="text-center fs-5">Réponse1 : {{q.option1}} <i *ngIf="q.optScoring1=='true'"
                                class="text-success fs-6 bi bi-check-lg"></i></p>
                        <div *ngIf="responsesMedias">
                            <div *ngFor="let item of responsesMedias">
                                <img *ngIf="item.includes(q.id) && item.includes('Option1')" class="img-fluid rounded"
                                    [src]="item">
                            </div>
                        </div>
                        <!-- si pas d'images -->
                    </div>
                    <div class="col-sm-6 rounded" [ngClass]="{'text-success':q.optScoring2=='true'}">
                        <p class="text-center fs-5">Réponse2 : {{q.option2}} <i *ngIf="q.optScoring2=='true'"
                                class="text-success fs-6 bi bi-check-lg"></i></p>
                        <div *ngIf="responsesMedias">
                            <div *ngFor="let item of responsesMedias">
                                <img *ngIf="item.includes(q.id) && item.includes('Option2')" class="img-fluid rounded"
                                    [src]="item">
                            </div>
                        </div>
                    </div>
                    <!-- à partir d'ici, les options Réponse 3 et Réponse 4 n'étant pas obligatoires, faut qu'on s'assure qu'elles existent -->
                    <div class="col-sm-6 rounded" *ngIf="q.option3" [ngClass]="{'text-success':q.optScoring3=='true'}">
                        <p class="text-center fs-5">Réponse3 : {{q.option3}} <i *ngIf="q.optScoring3=='true'"
                                class="text-success fs-6 bi bi-check-lg"></i></p>
                        <div *ngIf="responsesMedias">
                            <div *ngFor="let item of responsesMedias">
                                <img *ngIf="item.includes(q.id) && item.includes('Option3')" class="img-fluid rounded"
                                    [src]="item">
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-6 rounded" *ngIf="q.option4" [ngClass]="{'text-success':q.optScoring4=='true'}">
                        <p class="text-center fs-5">Réponse4 : {{q.option4}} <i *ngIf="q.optScoring4=='true'"
                                class="text-success fs-6 bi bi-check-lg"></i></p>
                        <div *ngIf="responsesMedias">
                            <div *ngFor="let item of responsesMedias">
                                <img *ngIf="item.includes(q.id) && item.includes('Option4')" class="img-fluid rounded"
                                    [src]="item">
                            </div>
                        </div>
                    </div>

                </div>
                <!-- fin des réponses -->

            </div>

        </div>
    </div>
</div>